%include "macros/patch.inc"

@LJMP 0x00447563, _BuildingClass__Get_Action_Cursor_No_Cursor_While_Selling ; Fixes invisible MCV exploit

_BuildingClass__Get_Action_Cursor_No_Cursor_While_Selling:
	mov ecx, esi
	call 0x004494C0 ; BuildingClass::Is_Sellable() ?
	cmp al, 0
	jz .Not_Sellable ; when not sellable
	
.Ret_Normal_Code:
	mov eax, [esi+520h]
	mov ecx, [eax+408h]
	jmp 0x00447569
	
.Not_Sellable:
	mov eax, [esi+520h]
	cmp byte [eax+0x16B9], 1 ; is BuildingType ConstrucionYard ?
	jz 0x00447558
	jmp .Ret_Normal_Code